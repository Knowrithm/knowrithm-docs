/* Knowrithm chat widget overrides
   - Keep navigation layers independent from the floating widget
   - Constrain the widget hit-area so it never masks navbar icons
   - Ensure assistant responses stay high-contrast in both themes */

:root {
    --knowrithm-nav-layer: 120;
    --knowrithm-widget-layer: 40;
    --knowrithm-widget-layer-active: 180;
}

#table-of-contents,
#table-of-contents-layout,
#table-of-contents-content,
.table-of-contents {
    z-index: calc(var(--knowrithm-widget-layer) - 20) !important;
}

#navbar {
    z-index: var(--knowrithm-nav-layer) !important;
    isolation: isolate;
}

#navbar .nav-logo,
#navbar nav,
#navbar button,
#navbar a,
#navbar svg {
    position: relative;
    z-index: 1;
}

#navbar nav ul {
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

#navbar .flex.items-center {
    gap: 0.75rem;
}

html:not(.dark) #navbar img.nav-logo.dark\:hidden {
    display: block !important;
}

html:not(.dark) #navbar img.nav-logo.dark\:block {
    display: none !important;
}

html.dark #navbar img.nav-logo.dark\:hidden {
    display: none !important;
}

html.dark #navbar img.nav-logo.dark\:block {
    display: block !important;
}

html:not(.dark) #navbar button[aria-label="Toggle dark mode"] .dark\:hidden {
    display: inline-flex !important;
}

html:not(.dark) #navbar button[aria-label="Toggle dark mode"] .dark\:block {
    display: none !important;
}

html.dark #navbar button[aria-label="Toggle dark mode"] .dark\:hidden {
    display: none !important;
}

html.dark #navbar button[aria-label="Toggle dark mode"] .dark\:block {
    display: inline-flex !important;
}

.ai-chat-widget {
    pointer-events: none;
    width: max-content;
    max-width: min(420px, calc(100vw - 32px));
    z-index: var(--knowrithm-widget-layer) !important;
}

.ai-chat-widget .ai-chat-button,
.ai-chat-widget .ai-chat-window,
.ai-chat-widget .ai-chat-modal-overlay {
    pointer-events: auto;
}

.ai-chat-widget .ai-chat-window {
    z-index: calc(var(--knowrithm-widget-layer) + 1) !important;
}

.ai-chat-modal-overlay {
    z-index: calc(var(--knowrithm-widget-layer) + 5) !important;
    background: rgba(15, 23, 42, 0.78) !important;
    backdrop-filter: blur(10px);
}

.ai-chat-widget.ai-chat-open {
    z-index: var(--knowrithm-widget-layer-active) !important;
}

.ai-chat-widget.ai-chat-open .ai-chat-button {
    z-index: calc(var(--knowrithm-widget-layer-active) + 1) !important;
}

.ai-chat-widget.ai-chat-open .ai-chat-window {
    z-index: calc(var(--knowrithm-widget-layer-active) + 2) !important;
}

.ai-chat-widget.ai-chat-open .ai-chat-modal-overlay {
    z-index: calc(var(--knowrithm-widget-layer-active) + 5) !important;
}

.ai-chat-widget .ai-chat-message.assistant {
    color: #0f172a !important;
    background: #ffffff !important;
}

.ai-chat-widget .ai-chat-message.user {
    color: #ffffff !important;
}

.ai-chat-widget.ai-chat-theme-dark .ai-chat-message.assistant,
.ai-chat-widget[data-theme="dark"] .ai-chat-message.assistant {
    color: #f8fafc !important;
    background: #1f2937 !important;
}

.ai-chat-widget .ai-chat-message.assistant a {
    color: #0369a1 !important;
    text-decoration-color: rgba(3, 105, 161, 0.4);
}

.ai-chat-widget .ai-chat-messages {
    color: #0f172a;
}

.ai-chat-widget .ai-chat-input,
.ai-chat-widget .ai-chat-button,
.ai-chat-widget .ai-chat-branding {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

@media (max-width: 640px) {
    .ai-chat-widget {
        max-width: calc(100vw - 24px);
    }
}
